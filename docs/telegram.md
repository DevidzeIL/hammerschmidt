# Telegram –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ Bot Token

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ Chat ID

#### –ú–µ—Ç–æ–¥ 1: –ß–µ—Ä–µ–∑ getUpdates API

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
   ```
   https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates
   ```
   –ó–∞–º–µ–Ω–∏—Ç–µ `<YOUR_BOT_TOKEN>` –Ω–∞ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞.

2. –ù–∞–π–¥–∏—Ç–µ –≤ –æ—Ç–≤–µ—Ç–µ –æ–±—ä–µ–∫—Ç —Å `"message"` –∏–ª–∏ `"chat"`:
   ```json
   {
     "ok": true,
     "result": [
       {
         "update_id": 123456789,
         "message": {
           "message_id": 1,
           "from": {
             "id": 277668379,
             "is_bot": false,
             "first_name": "Your Name"
           },
           "chat": {
             "id": 277668379,
             "first_name": "Your Name",
             "type": "private"
           },
           "date": 1234567890,
           "text": "Hello"
         }
       }
     ]
   }
   ```

3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `chat.id` (–≤ –ø—Ä–∏–º–µ—Ä–µ: `277668379`)

#### –ú–µ—Ç–æ–¥ 2: –ß–µ—Ä–µ–∑ –±–æ—Ç–∞

1. –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–µ–º—É –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –ó–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ:
   ```
   https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates
   ```
3. –ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ `chat.id`

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à `.env` —Ñ–∞–π–ª:

```env
# Telegram Notifications
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=277668379

# App URL (–¥–ª—è —Å—Å—ã–ª–æ–∫ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö)
APP_URL=http://localhost:3000
```

**–í–∞–∂–Ω–æ:**
- –í **development** —Ä–µ–∂–∏–º–µ, –µ—Å–ª–∏ `TELEGRAM_CHAT_ID` –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `277668379`
- –í **production** —Ä–µ–∂–∏–º–µ `TELEGRAM_CHAT_ID` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –∏–Ω–∞—á–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ `NotificationLog` –≤ Prisma schema:

```bash
pnpm prisma migrate dev --name add_notification_log
```

–ò–ª–∏ –¥–ª—è production:

```bash
pnpm prisma migrate deploy
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –Ω–∞ —Å–∞–π—Ç–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

### –§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```
üÜï –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ #abc123
üë§ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ (–û–û–û "–ö–æ–º–ø–∞–Ω–∏—è")
‚òéÔ∏è +7 (999) 123-45-67   ‚úâÔ∏è ivan@example.com

üì¶ –ü–æ–∑–∏—Ü–∏–∏:
- –¢–æ–≤–∞—Ä A √ó 10  (150.00 ‚ÇΩ)
- –¢–æ–≤–∞—Ä B √ó 5  (200.00 ‚ÇΩ)

üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: –ù—É–∂–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ –¥–æ –∫–æ–Ω—Ü–∞ –Ω–µ–¥–µ–ª–∏

üîó –ê–¥–º–∏–Ω–∫–∞: http://localhost:3000/admin/requests/clx...
```

## –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

- –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `NotificationLog`
- –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å `SENT` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å `SKIPPED` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å `FAILED` - —Å–∏—Å—Ç–µ–º–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–Ω–æ–≤–∞

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:

- `[Telegram] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ` - —É—Å–ø–µ—Ö
- `[Telegram] –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è` - –æ—à–∏–±–∫–∞
- `[Telegram] TELEGRAM_BOT_TOKEN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –û—à–∏–±–∫–∏ Telegram **–Ω–µ –≤–ª–∏—è—é—Ç** –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
- –ü—Ä–∏ network/timeout –æ—à–∏–±–∫–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è 1 –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
- –û—à–∏–±–∫–∏ –æ—Ç Telegram API (–Ω–∞–ø—Ä–∏–º–µ—Ä, chat not found) –Ω–µ —Ä–µ—Ç—Ä–∞—è—Ç—Å—è
- –í—Å–µ –æ—à–∏–±–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `NotificationLog` —Å —Å—Ç–∞—Ç—É—Å–æ–º `FAILED`

## –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–ß—Ç–æ–±—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç–µ –∏–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ `TELEGRAM_BOT_TOKEN` –≤ `.env`:

```env
# TELEGRAM_BOT_TOKEN=...
```

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏ –æ—Ç–∫–ª—é—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º –≤ –ª–æ–≥–∞—Ö.
